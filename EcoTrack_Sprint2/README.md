# EcoTrack.Net 🌱

Projeto desenvolvido para o Challenge FIAP 2TDS — matéria .NET.  
API REST em **ASP.NET Core 8** com **Entity Framework Core + Oracle Database**, seguindo arquitetura em camadas.

---

## 🎯 Objetivo
O **EcoTrack.Net** permite cadastrar, consultar, atualizar e remover produtos com informações nutricionais e impacto ambiental (CO₂ por unidade).  
Essa API é parte da solução EcoTrack que visa ajudar usuários a tomarem decisões mais conscientes sobre alimentação e sustentabilidade.

---

## 🏗️ Arquitetura
- **Domain** → Entidades e contratos (ex.: `Product`).
- **Application** → DTOs e serviços de negócio.
- **Infrastructure** → DbContext e repositórios com EF Core + Oracle.
- **Net (WebApi)** → Endpoints REST com Swagger.

---

## ⚙️ Pré-requisitos
- .NET 8 SDK  
- Oracle Database 21c XE ou acesso ao Oracle FIAP  
- Postman (opcional, para testar os endpoints)

---

## 📂 Estrutura de Pastas
```

EcoTrack.Net/
┣ EcoTrack.Domain/
┣ EcoTrack.Application/
┣ EcoTrack.Infrastructure/
┣ EcoTrack.Net/
┗ docs/
┣ products_oracle.sql
┣ sample_inserts.sql
┗ EcoTrack.postman_collection.json

````

## 🗄️ Banco de Dados
Criação da tabela (docs/products_oracle.sql):
```sql
CREATE TABLE PRODUCTS (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NAME VARCHAR2(255) NOT NULL,
    CATEGORY VARCHAR2(100) NOT NULL,
    CALORIESPER100G NUMBER(6,2),
    CO2PERUNIT NUMBER(6,2),
    BARCODE VARCHAR2(50) UNIQUE
);
````

Exemplo de insert (docs/sample_inserts.sql):

```sql
INSERT INTO PRODUCTS (NAME, CATEGORY, CALORIESPER100G, CO2PERUNIT, BARCODE)
VALUES ('Achocolatado Eco', 'Bebidas', 89.5, 0.42, '7891000123456');
```

---

## ⚡ Configuração

1. Clone o repositório:

```bash
git clone https://github.com/Pnetoo/.NET-EcoTrack.git
cd .NET-EcoTrack
```

2. Ajuste a connection string (appsettings.json):

```json
{
  "ConnectionStrings": {
    "Oracle": "User Id=rm560262;Password=SYSADM;Data Source=oracle.fiap.com.br:1521/SERVICE"
  }
}
```

3. Restaure e rode:

```bash
dotnet restore
dotnet build
dotnet run --project EcoTrack.Net
```

API disponível em:
👉 [http://localhost:5000/swagger](http://localhost:5000/swagger)

---

## 📚 Endpoints

Todos documentados via Swagger:

* GET `/api/Products`
* GET `/api/Products/{id}`
* POST `/api/Products`
* PUT `/api/Products/{id}`
* DELETE `/api/Products/{id}`

---

## 🧪 Testes com Postman

Importe `docs/EcoTrack.postman_collection.json` no Postman para testar os endpoints.

---

## 👨‍💻 Autor

* **Pnetoo ([rm560262@fiap.com.br](mailto:rm560262@fiap.com.br))**
* Repositório: [https://github.com/Pnetoo/.NET-EcoTrack](https://github.com/Pnetoo/.NET-EcoTrack)

---

## ✅ Status da Entrega

* [x] CRUD completo (Products)
* [x] Swagger configurado
* [x] Arquitetura em camadas
* [x] Conexão com Oracle (DDL disponível)
* [x] Postman Collection
* [x] Documentação

```

## Sprint 2 changes (implemented)

- Implemented search route with pagination, filtering, sorting and HATEOAS links: `GET /api/products?q=&category=&sortBy=name|kcal|co2|category&sortDir=asc|desc&page=1&pageSize=10`
- Implemented repository sorting support and extended service signatures.
- Added LinkGenerator-based HATEOAS links for items and paging (self, next, prev, first, last).
- Program.cs now registers an InMemory EF Core database for easy testing (you can swap to Oracle by updating DbContext registration).
- Updated README with usage examples.

### Example: GET products
`GET /api/products?q=apple&page=1&pageSize=5&sortBy=kcal&sortDir=asc`

### How to run locally (Windows / Linux)
1. Ensure .NET SDK 7+ is installed.
2. From the solution folder run:
```bash
cd EcoTrack.Net
dotnet run
```
3. Open `http://localhost:5000/swagger` to test endpoints.

